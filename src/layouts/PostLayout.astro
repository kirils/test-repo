---
import BaseLayout from './BaseLayout.astro';
import { siteUrl } from '../utils/url';

interface Props {
  title:       string;
  description: string;
  pubDate:     Date;
  updatedDate?: Date;
}

const { title, description, pubDate, updatedDate } = Astro.props;

const formattedPub = pubDate.toLocaleDateString('en-US', {
  year: 'numeric', month: 'long', day: 'numeric',
});

const formattedUpdated = updatedDate?.toLocaleDateString('en-US', {
  year: 'numeric', month: 'long', day: 'numeric',
});
---

<BaseLayout title={title} description={description}>
  <div class="container post-wrapper">
    <article class="post" aria-labelledby="post-title">
      <header class="post-header">
        <a href={siteUrl('blog')} class="back-link">
          <span aria-hidden="true">&larr;</span> All posts
        </a>

        <h1 id="post-title" class="post-title">{title}</h1>

        <div class="post-meta">
          <time datetime={pubDate.toISOString()}>
            Published {formattedPub}
          </time>
          {updatedDate && (
            <time datetime={updatedDate.toISOString()} class="updated">
              &middot; Updated {formattedUpdated}
            </time>
          )}
        </div>
      </header>

      <div class="prose post-body">
        <slot />
      </div>
    </article>
  </div>
</BaseLayout>

<style>
  .post-wrapper {
    padding-block: var(--space-12);
  }

  .post {
    max-width: var(--prose-width);
    margin-inline: auto;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    text-decoration: none;
    margin-bottom: var(--space-6);
  }

  .back-link:hover {
    color: var(--color-primary);
    text-decoration: underline;
  }

  .post-header {
    margin-bottom: var(--space-8);
  }

  .post-title {
    margin-top: var(--space-3);
    margin-bottom: var(--space-3);
  }

  .post-meta {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .updated {
    margin-left: var(--space-1);
  }

  .post-body {
    border-top: 1px solid var(--color-border);
    padding-top: var(--space-8);
  }
</style>
