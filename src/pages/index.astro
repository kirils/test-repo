---
import BaseLayout from '../layouts/BaseLayout.astro';
import Card from '../components/Card.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);
---

<BaseLayout
  title="AstroDemo — Fast, accessible websites with Astro"
  description="A demonstration site showcasing Astro's static site generation, Content Collections, and zero-JS-by-default architecture."
>
  <!-- Hero -->
  <section class="hero" aria-labelledby="hero-heading">
    <div class="container hero-inner">
      <div class="hero-badge">Built with Astro 4</div>
      <h1 id="hero-heading" class="hero-title">
        Fast websites, <br />by default.
      </h1>
      <p class="hero-description">
        AstroDemo is an open-source starter that demonstrates Astro's island
        architecture, Content Collections, and static-site generation — all
        without a single byte of unnecessary JavaScript.
      </p>
      <div class="hero-actions">
        <a href="/blog" class="btn btn-primary">Read the blog</a>
        <a href="/about" class="btn btn-secondary">About this project</a>
      </div>
    </div>
  </section>

  <!-- Feature highlights -->
  <section class="features" aria-labelledby="features-heading">
    <div class="container">
      <h2 id="features-heading" class="section-title">Why Astro?</h2>
      <ul class="feature-grid" role="list">
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">&#9889;</span>
          <h3 class="feature-name">Zero JS by default</h3>
          <p class="feature-desc">Pages ship as pure HTML and CSS. JavaScript is opt-in, per component.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">&#128196;</span>
          <h3 class="feature-name">Content Collections</h3>
          <p class="feature-desc">Type-safe Markdown with Zod schema validation baked in.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">&#127760;</span>
          <h3 class="feature-name">Static output</h3>
          <p class="feature-desc">Deploy anywhere — Netlify, Vercel, GitHub Pages, or plain S3.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">&#9745;</span>
          <h3 class="feature-name">Accessible first</h3>
          <p class="feature-desc">Semantic HTML, WCAG AA contrast, skip links, and keyboard navigation.</p>
        </li>
      </ul>
    </div>
  </section>

  <!-- Recent posts -->
  {posts.length > 0 && (
    <section class="recent-posts" aria-labelledby="posts-heading">
      <div class="container">
        <div class="section-header">
          <h2 id="posts-heading" class="section-title">Recent posts</h2>
          <a href="/blog" class="view-all">View all &rarr;</a>
        </div>
        <ul class="card-grid" role="list">
          {posts.map((post) => (
            <li>
              <Card
                title={post.data.title}
                description={post.data.description}
                href={`/blog/${post.slug}`}
                pubDate={post.data.pubDate}
              />
            </li>
          ))}
        </ul>
      </div>
    </section>
  )}
</BaseLayout>

<style>
  /* Hero */
  .hero {
    background: linear-gradient(
      160deg,
      var(--color-surface) 0%,
      var(--color-bg) 60%
    );
    padding-block: var(--space-24);
    border-bottom: 1px solid var(--color-border);
  }

  .hero-inner {
    max-width: 48rem;
  }

  .hero-badge {
    display: inline-block;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-primary);
    background: color-mix(in srgb, var(--color-primary) 10%, transparent);
    border: 1px solid color-mix(in srgb, var(--color-primary) 30%, transparent);
    border-radius: 9999px;
    padding: var(--space-1) var(--space-3);
    margin-bottom: var(--space-6);
  }

  .hero-title {
    font-size: clamp(var(--text-3xl), 5vw, 3.5rem);
    line-height: 1.05;
    letter-spacing: -0.03em;
    margin-bottom: var(--space-6);
  }

  .hero-description {
    font-size: var(--text-lg);
    color: var(--color-text-muted);
    max-width: 44ch;
    margin-bottom: var(--space-8);
  }

  .hero-actions {
    display: flex;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    padding: var(--space-3) var(--space-6);
    border-radius: var(--radius-md);
    font-size: var(--text-base);
    font-weight: 600;
    text-decoration: none;
    transition: background-color 0.15s, color 0.15s, box-shadow 0.15s;
  }

  .btn-primary {
    background: var(--color-primary);
    color: #fff;
  }

  .btn-primary:hover {
    background: var(--color-primary-hover);
    color: #fff;
  }

  .btn-secondary {
    background: var(--color-surface);
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }

  .btn-secondary:hover {
    background: var(--color-border);
  }

  /* Features */
  .features {
    padding-block: var(--space-16);
    border-bottom: 1px solid var(--color-border);
  }

  .section-title {
    margin-bottom: var(--space-8);
  }

  .feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: var(--space-6);
    list-style: none;
  }

  .feature-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .feature-icon {
    font-size: var(--text-2xl);
  }

  .feature-name {
    font-size: var(--text-lg);
    font-weight: 600;
  }

  .feature-desc {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    line-height: 1.6;
  }

  /* Recent posts */
  .recent-posts {
    padding-block: var(--space-16);
  }

  .section-header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: var(--space-4);
    margin-bottom: var(--space-8);
    flex-wrap: wrap;
  }

  .section-header .section-title {
    margin-bottom: 0;
  }

  .view-all {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-primary);
    white-space: nowrap;
  }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-6);
    list-style: none;
  }
</style>
