---
import BaseLayout from '../layouts/BaseLayout.astro';
import Card from '../components/Card.astro';
import StarField from '../components/StarField.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);
---

<BaseLayout
  title="AstroDemo — Fast, accessible websites with Astro"
  description="A demonstration site showcasing Astro's static site generation, Content Collections, and zero-JS-by-default architecture."
>
  <!-- Hero with animated star field -->
  <section class="hero" aria-labelledby="hero-heading">
    <StarField />
    <div class="container hero-inner">
      <div class="hero-badge">Built with Astro 4</div>
      <h1 id="hero-heading" class="hero-title">
        Fast websites,<br />by default.
      </h1>
      <p class="hero-description">
        AstroDemo is an open-source starter that demonstrates Astro's island
        architecture, Content Collections, and static-site generation — all
        without a single byte of unnecessary JavaScript.
      </p>
      <div class="hero-actions">
        <a href="/blog" class="btn btn-primary">Read the blog</a>
        <a href="/about" class="btn btn-secondary">About this project</a>
      </div>

      <!-- Scroll indicator -->
      <div class="scroll-hint" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
             fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
             stroke-linejoin="round">
          <polyline points="6 9 12 15 18 9"/>
        </svg>
      </div>
    </div>
  </section>

  <!-- Stats bar -->
  <section class="stats" aria-label="Project stats">
    <div class="container stats-inner">
      <div class="stat">
        <span class="stat-value">0 KB</span>
        <span class="stat-label">JavaScript shipped by default</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat">
        <span class="stat-value">100</span>
        <span class="stat-label">Lighthouse performance score</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat">
        <span class="stat-value">WCAG AA</span>
        <span class="stat-label">Accessibility standard</span>
      </div>
      <div class="stat-divider" aria-hidden="true"></div>
      <div class="stat">
        <span class="stat-value">&infin;</span>
        <span class="stat-label">Deploy targets supported</span>
      </div>
    </div>
  </section>

  <!-- Feature highlights -->
  <section class="features" aria-labelledby="features-heading">
    <div class="container">
      <h2 id="features-heading" class="section-title">Why Astro?</h2>
      <ul class="feature-grid" role="list">
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
            </svg>
          </span>
          <h3 class="feature-name">Zero JS by default</h3>
          <p class="feature-desc">Pages ship as pure HTML and CSS. JavaScript is opt-in, per component, only when genuinely needed.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10 9 9 9 8 9"/>
            </svg>
          </span>
          <h3 class="feature-name">Content Collections</h3>
          <p class="feature-desc">Type-safe Markdown with Zod schema validation — catch frontmatter errors at build time, not runtime.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <circle cx="12" cy="12" r="10"/>
              <line x1="2" y1="12" x2="22" y2="12"/>
              <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
          </span>
          <h3 class="feature-name">Deploy anywhere</h3>
          <p class="feature-desc">Static output means any CDN works — Netlify, Vercel, GitHub Pages, Cloudflare, or a plain S3 bucket.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
          </span>
          <h3 class="feature-name">Accessible first</h3>
          <p class="feature-desc">Semantic HTML, WCAG AA contrast ratios, skip links, visible focus rings, and keyboard navigation baked in.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
            </svg>
          </span>
          <h3 class="feature-name">TypeScript strict</h3>
          <p class="feature-desc">Every component and layout is fully typed. No implicit <code>any</code>, no exceptions — the compiler is your safety net.</p>
        </li>
        <li class="feature-item">
          <span class="feature-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                 stroke-linejoin="round" aria-hidden="true">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.07 4.93a10 10 0 0 1 0 14.14M4.93 4.93a10 10 0 0 0 0 14.14"/>
            </svg>
          </span>
          <h3 class="feature-name">Island architecture</h3>
          <p class="feature-desc">Opt components into the client selectively — <code>client:idle</code>, <code>client:visible</code> — hydrating only what users interact with.</p>
        </li>
      </ul>
    </div>
  </section>

  <!-- Recent posts -->
  {posts.length > 0 && (
    <section class="recent-posts" aria-labelledby="posts-heading">
      <div class="container">
        <div class="section-header">
          <h2 id="posts-heading" class="section-title">Recent posts</h2>
          <a href="/blog" class="view-all">View all &rarr;</a>
        </div>
        <ul class="card-grid" role="list">
          {posts.map((post) => (
            <li>
              <Card
                title={post.data.title}
                description={post.data.description}
                href={`/blog/${post.slug}`}
                pubDate={post.data.pubDate}
              />
            </li>
          ))}
        </ul>
      </div>
    </section>
  )}

  <!-- CTA Banner -->
  <section class="cta-banner" aria-labelledby="cta-heading">
    <div class="container cta-inner">
      <div class="cta-text">
        <h2 id="cta-heading" class="cta-title">Ready to build something fast?</h2>
        <p class="cta-desc">Clone the repo, read the docs, and ship a site that scores 100 on Lighthouse out of the box.</p>
      </div>
      <div class="cta-actions">
        <a href="/about" class="btn btn-primary">Learn more</a>
        <a href="/blog" class="btn btn-outline">Read the blog</a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  /* ── Hero ─────────────────────────────────────────── */
  .hero {
    position: relative;
    overflow: hidden;
    background: linear-gradient(160deg, #0a0a14 0%, #0d0d22 60%, #070710 100%);
    padding-block: var(--space-24);
    border-bottom: 1px solid rgba(255 255 255 / 0.06);
    min-height: 80vh;
    display: flex;
    align-items: center;
  }

  .hero-inner {
    position: relative;
    z-index: 1;
    max-width: 52rem;
  }

  .hero-badge {
    display: inline-block;
    font-size: var(--text-sm);
    font-weight: 600;
    color: #93c5fd;
    background: rgba(96 165 250 / 0.12);
    border: 1px solid rgba(96 165 250 / 0.3);
    border-radius: 9999px;
    padding: var(--space-1) var(--space-3);
    margin-bottom: var(--space-6);
    letter-spacing: 0.02em;
  }

  .hero-title {
    font-size: clamp(var(--text-3xl), 6vw, 4rem);
    line-height: 1.05;
    letter-spacing: -0.03em;
    margin-bottom: var(--space-6);
    color: #ffffff;
    text-shadow: 0 0 80px rgba(96 165 250 / 0.3);
  }

  .hero-description {
    font-size: var(--text-lg);
    color: rgba(255 255 255 / 0.65);
    max-width: 46ch;
    margin-bottom: var(--space-8);
    line-height: 1.7;
  }

  .hero-actions {
    display: flex;
    gap: var(--space-3);
    flex-wrap: wrap;
  }

  .scroll-hint {
    margin-top: var(--space-16);
    color: rgba(255 255 255 / 0.3);
    animation: bounce 2.5s ease-in-out infinite;
    width: fit-content;
  }

  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50%       { transform: translateY(6px); }
  }

  /* ── Buttons ──────────────────────────────────────── */
  .btn {
    display: inline-flex;
    align-items: center;
    padding: var(--space-3) var(--space-6);
    border-radius: var(--radius-md);
    font-size: var(--text-base);
    font-weight: 600;
    text-decoration: none;
    transition: background-color 0.15s, color 0.15s, box-shadow 0.15s, border-color 0.15s;
  }

  .btn-primary {
    background: var(--color-primary);
    color: #fff;
  }
  .btn-primary:hover {
    background: var(--color-primary-hover);
    color: #fff;
    text-decoration: none;
  }

  .btn-secondary {
    background: rgba(255 255 255 / 0.08);
    color: rgba(255 255 255 / 0.9);
    border: 1px solid rgba(255 255 255 / 0.15);
  }
  .btn-secondary:hover {
    background: rgba(255 255 255 / 0.14);
    color: #fff;
    text-decoration: none;
  }

  .btn-outline {
    background: transparent;
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }
  .btn-outline:hover {
    background: var(--color-surface);
    text-decoration: none;
  }

  /* ── Stats bar ────────────────────────────────────── */
  .stats {
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
  }

  .stats-inner {
    display: flex;
    align-items: center;
    justify-content: space-around;
    padding-block: var(--space-6);
    gap: var(--space-4);
    flex-wrap: wrap;
  }

  .stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-1);
    text-align: center;
    flex: 1;
    min-width: 120px;
  }

  .stat-value {
    font-size: var(--text-2xl);
    font-weight: 800;
    color: var(--color-primary);
    letter-spacing: -0.02em;
  }

  .stat-label {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .stat-divider {
    width: 1px;
    height: 2.5rem;
    background: var(--color-border);
    flex-shrink: 0;
  }

  @media (max-width: 40rem) {
    .stat-divider { display: none; }
  }

  /* ── Features ─────────────────────────────────────── */
  .features {
    padding-block: var(--space-16);
    border-bottom: 1px solid var(--color-border);
  }

  .section-title {
    margin-bottom: var(--space-8);
  }

  .feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: var(--space-6);
    list-style: none;
  }

  .feature-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    padding: var(--space-6);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .feature-item:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
  }

  .feature-icon {
    color: var(--color-primary);
  }

  .feature-name {
    font-size: var(--text-lg);
    font-weight: 600;
  }

  .feature-desc {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    line-height: 1.65;
  }

  .feature-desc code {
    font-size: 0.8em;
    background: var(--color-border);
    border-radius: var(--radius-sm);
    padding: 0.1em 0.3em;
  }

  /* ── Recent posts ─────────────────────────────────── */
  .recent-posts {
    padding-block: var(--space-16);
    border-bottom: 1px solid var(--color-border);
  }

  .section-header {
    display: flex;
    align-items: baseline;
    justify-content: space-between;
    gap: var(--space-4);
    margin-bottom: var(--space-8);
    flex-wrap: wrap;
  }

  .section-header .section-title {
    margin-bottom: 0;
  }

  .view-all {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-primary);
    white-space: nowrap;
    text-decoration: none;
  }
  .view-all:hover { text-decoration: underline; }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-6);
    list-style: none;
  }

  /* ── CTA banner ───────────────────────────────────── */
  .cta-banner {
    padding-block: var(--space-16);
    background: linear-gradient(
      135deg,
      color-mix(in srgb, var(--color-primary) 8%, var(--color-bg)),
      color-mix(in srgb, var(--color-accent) 6%, var(--color-bg))
    );
    border-top: 1px solid var(--color-border);
  }

  .cta-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-8);
    flex-wrap: wrap;
  }

  .cta-text {
    max-width: 40ch;
  }

  .cta-title {
    font-size: var(--text-2xl);
    margin-bottom: var(--space-3);
  }

  .cta-desc {
    color: var(--color-text-muted);
    line-height: 1.6;
  }

  .cta-actions {
    display: flex;
    gap: var(--space-3);
    flex-shrink: 0;
    flex-wrap: wrap;
  }
</style>
